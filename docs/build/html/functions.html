
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Functions &#8212; spinWannier 0.1.5 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=98feffa1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'functions';</script>
    <link rel="icon" href="_static/android-chrome-192x192.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Classes" href="classes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title"><b>spinWannier</b> 0.1.5 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">Modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/spinWannier.wannier_utils.html">spinWannier.wannier_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/spinWannier.wannier_quality_utils.html">spinWannier.wannier_quality_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/spinWannier.WannierTBmodel.html">spinWannier.WannierTBmodel</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Functions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/liborsold/spinWannier" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/functions.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Functions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.S_xyz_expectation_values"><code class="docutils literal notranslate"><span class="pre">S_xyz_expectation_values()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.W_gauge_to_H_gauge"><code class="docutils literal notranslate"><span class="pre">W_gauge_to_H_gauge()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.band_with_spin_projection_under_threshold_for_kpoint"><code class="docutils literal notranslate"><span class="pre">band_with_spin_projection_under_threshold_for_kpoint()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.check_file_exists"><code class="docutils literal notranslate"><span class="pre">check_file_exists()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.coerce_R_vectors_to_basic_supercell"><code class="docutils literal notranslate"><span class="pre">coerce_R_vectors_to_basic_supercell()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.coerce_to_positive_angles"><code class="docutils literal notranslate"><span class="pre">coerce_to_positive_angles()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.convert_wann_TB_model_for_QuT"><code class="docutils literal notranslate"><span class="pre">convert_wann_TB_model_for_QuT()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.dict_to_matrix"><code class="docutils literal notranslate"><span class="pre">dict_to_matrix()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.eigenval_dict"><code class="docutils literal notranslate"><span class="pre">eigenval_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.eigenval_for_kpoint"><code class="docutils literal notranslate"><span class="pre">eigenval_for_kpoint()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.fermi_surface_spin_texture"><code class="docutils literal notranslate"><span class="pre">fermi_surface_spin_texture()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.files_wann90_to_dict_pickle"><code class="docutils literal notranslate"><span class="pre">files_wann90_to_dict_pickle()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_2D_kpoint_mesh"><code class="docutils literal notranslate"><span class="pre">get_2D_kpoint_mesh()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_DFT_kgrid"><code class="docutils literal notranslate"><span class="pre">get_DFT_kgrid()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_kpoint_names"><code class="docutils literal notranslate"><span class="pre">get_kpoint_names()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_kpoint_path"><code class="docutils literal notranslate"><span class="pre">get_kpoint_path()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_skiprows_hr_dat"><code class="docutils literal notranslate"><span class="pre">get_skiprows_hr_dat()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.hr_wann90_to_dict"><code class="docutils literal notranslate"><span class="pre">hr_wann90_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.interpolate_operator"><code class="docutils literal notranslate"><span class="pre">interpolate_operator()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.load_dict"><code class="docutils literal notranslate"><span class="pre">load_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.load_eigenvals"><code class="docutils literal notranslate"><span class="pre">load_eigenvals()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.load_lattice_vectors"><code class="docutils literal notranslate"><span class="pre">load_lattice_vectors()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.magmom_OOP_or_IP"><code class="docutils literal notranslate"><span class="pre">magmom_OOP_or_IP()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.magmom_direction"><code class="docutils literal notranslate"><span class="pre">magmom_direction()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.material_name_to_latex"><code class="docutils literal notranslate"><span class="pre">material_name_to_latex()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.matrix_to_dict"><code class="docutils literal notranslate"><span class="pre">matrix_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.operator_exp_values"><code class="docutils literal notranslate"><span class="pre">operator_exp_values()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.outer"><code class="docutils literal notranslate"><span class="pre">outer()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.outer2"><code class="docutils literal notranslate"><span class="pre">outer2()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.parse_KPOINTS_file"><code class="docutils literal notranslate"><span class="pre">parse_KPOINTS_file()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.plot_bands_spin_texture"><code class="docutils literal notranslate"><span class="pre">plot_bands_spin_texture()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.read_PROCAR_lines_for_kpoint"><code class="docutils literal notranslate"><span class="pre">read_PROCAR_lines_for_kpoint()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.real_space_grid_from_hr_dat"><code class="docutils literal notranslate"><span class="pre">real_space_grid_from_hr_dat()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.real_to_W_gauge"><code class="docutils literal notranslate"><span class="pre">real_to_W_gauge()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.real_to_W_gauge_accelerated"><code class="docutils literal notranslate"><span class="pre">real_to_W_gauge_accelerated()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.reciprocal_lattice_vectors"><code class="docutils literal notranslate"><span class="pre">reciprocal_lattice_vectors()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.replace_middle_of_cmap_with_custom_color"><code class="docutils literal notranslate"><span class="pre">replace_middle_of_cmap_with_custom_color()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.save_bands_and_spin_texture"><code class="docutils literal notranslate"><span class="pre">save_bands_and_spin_texture()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.save_bands_and_spin_texture_old"><code class="docutils literal notranslate"><span class="pre">save_bands_and_spin_texture_old()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.selected_band_plot"><code class="docutils literal notranslate"><span class="pre">selected_band_plot()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.split_spn_dict"><code class="docutils literal notranslate"><span class="pre">split_spn_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.spn_to_dict"><code class="docutils literal notranslate"><span class="pre">spn_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.u_to_dict"><code class="docutils literal notranslate"><span class="pre">u_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.uniform_real_space_grid"><code class="docutils literal notranslate"><span class="pre">uniform_real_space_grid()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.unite_spn_dict"><code class="docutils literal notranslate"><span class="pre">unite_spn_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.wannier_energy_windows"><code class="docutils literal notranslate"><span class="pre">wannier_energy_windows()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.compare_eigs_bandstructure_at_exact_kpts"><code class="docutils literal notranslate"><span class="pre">compare_eigs_bandstructure_at_exact_kpts()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.duplicate_kpoints_for_home_made"><code class="docutils literal notranslate"><span class="pre">duplicate_kpoints_for_home_made()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_NKpoints"><code class="docutils literal notranslate"><span class="pre">get_NKpoints()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_band_at_kpoint_from_EIGENVAL"><code class="docutils literal notranslate"><span class="pre">get_band_at_kpoint_from_EIGENVAL()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_fermi"><code class="docutils literal notranslate"><span class="pre">get_fermi()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_fermi_corrected_by_matching_bands"><code class="docutils literal notranslate"><span class="pre">get_fermi_corrected_by_matching_bands()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_frozen_window_min_max"><code class="docutils literal notranslate"><span class="pre">get_frozen_window_min_max()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.integrate_error"><code class="docutils literal notranslate"><span class="pre">integrate_error()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.parse_eigenval_file"><code class="docutils literal notranslate"><span class="pre">parse_eigenval_file()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.plot_err_vs_bands"><code class="docutils literal notranslate"><span class="pre">plot_err_vs_bands()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.plot_err_vs_energy"><code class="docutils literal notranslate"><span class="pre">plot_err_vs_energy()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.wannier_quality_calculation"><code class="docutils literal notranslate"><span class="pre">wannier_quality_calculation()</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="functions">
<h1>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h1>
<p>Support functions for spinWannier.</p>
<p id="module-spinWannier.wannier_utils">Utility functions for the spinWannier package.</p>
<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.S_xyz_expectation_values">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">S_xyz_expectation_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvecs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.S_xyz_expectation_values" title="Link to this definition">#</a></dt>
<dd><p>For a k-space Hamiltonian Hk (function of kx and ky), calculate the eigen-energies and expectation values of spin Sx, Sy, Sz, at all the k-points in ‘kpoints’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hk</strong> (<em>function</em>) – A function returning a 2x2 FEG Hamiltonian.</p></li>
<li><p><strong>kpoints</strong> (<em>array</em><em> of </em><em>tuples</em>) – Array of k-points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of expectation values for energy and spin expectation values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>four arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.W_gauge_to_H_gauge">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">W_gauge_to_H_gauge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">O_mn_k_W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_mn_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.W_gauge_to_H_gauge" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Transform from Wannier gauge to Hamiltonian gauge, i.e., for every k-point either diagonalize Hamiltonian</dt><dd><p>or use the matrix from previous Hamiltonian diagonalization (‘U_mn_k’) to transform some other operator
to H gauge.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>O_mn_k_W</strong> (<em>dict</em>) – The k-space operator dictionary in Wannier gauge.</p></li>
<li><p><strong>U_mn_k</strong> (<em>dict</em>) – The unitary matrices which diagonalize the Hamiltonian for each k-point.</p></li>
<li><p><strong>hamiltonian</strong> (<em>bool</em>) – If True, the operator is Hamiltonian and the U_mn_k will be determined; for any other operator they have to be provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-space operator dictionary in Hamiltonian gauge.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.band_with_spin_projection_under_threshold_for_kpoint">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">band_with_spin_projection_under_threshold_for_kpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_characters_considered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{0:</span> <span class="pre">[4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8],</span> <span class="pre">1:</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3],</span> <span class="pre">2:</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PROCAR_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PROCAR'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_lowest_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.band_with_spin_projection_under_threshold_for_kpoint" title="Link to this definition">#</a></dt>
<dd><p>Return the lowest band with the spin projection below the threshold for ‘kpoint’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoint</strong> (<em>tuple</em>) – The k-point.</p></li>
<li><p><strong>orbital_characters_considered</strong> (<em>dict</em>) – The orbital characters considered.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The threshold.</p></li>
<li><p><strong>PROCAR_file</strong> (<em>str</em>) – The PROCAR file.</p></li>
<li><p><strong>n_ions</strong> (<em>int</em>) – The number of ions.</p></li>
<li><p><strong>skip_lowest_bands</strong> (<em>int</em>) – The number of lowest bands to skip.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lowest band with the spin projection below the threshold for ‘kpoint’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.check_file_exists">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">check_file_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.check_file_exists" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Check if file exists. If yes, add him a number in parentheses that does not exist.</dt><dd><p>Return the new name.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>str</em>) – The file name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new file name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.coerce_R_vectors_to_basic_supercell">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">coerce_R_vectors_to_basic_supercell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R_tr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-3,</span> <span class="pre">2,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_mesh_ijk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">5,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.coerce_R_vectors_to_basic_supercell" title="Link to this definition">#</a></dt>
<dd><p>wannier90_hr.dat has sometimes the R vectors shifted (probably to facilitate the
‘minimal replice’ interpolation. Therefore, given some uniform grid centered at zero
(e.g. 5x5x1) and a translated R vectors from hr_dat file (e.g. (-3,2,0) ), we would like to get
the R vector’s image in the uniform grid, to be able to compare with our results.
For (-3,2,0) this would be (2,2,0) in case of (5,5,1) grid  (adding 5 to the ‘x’ coordinate).
-&gt; Algorithm: translate the ‘R’ by a supercell vector (in negative and positive direction and
for x, y, z separately -&gt; 8 possible translations: so searching the immediate vicinity of the R vector.
Return a dictionary from the ‘hr_dat grid’ to the uniform grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R_tr</strong> (<em>tuple</em><em> of </em><em>3 ints</em>) – The translated R vector.</p></li>
<li><p><strong>R_mesh_ijk</strong> (<em>tuple</em><em> of </em><em>3 ints</em>) – The uniform grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The translated R vector in the uniform grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of 3 ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.coerce_to_positive_angles">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">coerce_to_positive_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.coerce_to_positive_angles" title="Link to this definition">#</a></dt>
<dd><p>Coerce angles to be positive (i.e., in the range [0, 2pi]).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>angles</strong> (<em>np.array</em>) – The angles.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The coerced angles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.convert_wann_TB_model_for_QuT">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">convert_wann_TB_model_for_QuT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seedname_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'system'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wann_centres_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90_centres.xyz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_R_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hr_R_dict.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spn_R_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spn_R_dict.pickle'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.convert_wann_TB_model_for_QuT" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Convert the outputs of my wannier to TB to Joaquin’s code.</dt><dd><dl class="simple">
<dt>Generates files</dt><dd><p>{system_name}_Mx{Mx:d}My{My:d}Mz{Mz:d}_E{E:.2f}.uc        ….   unit cell
{system_name}_Mx{Mx:d}My{My:d}Mz{Mz:d}_E{E:.2f}.xyz       ….   wannier centers in cartesian coordinates
{system_name}_Mx{Mx:d}My{My:d}Mz{Mz:d}_E{E:.2f}_hr.dat    ….   real-space Hamiltonian
{system_name}_Mx{Mx:d}My{My:d}Mz{Mz:d}_E{E:.2f}_sxhr.dat  ….   real-space spin S_x operator
{system_name}_Mx{Mx:d}My{My:d}Mz{Mz:d}_E{E:.2f}_syhr.dat  ….   real-space spin S_y operator
{system_name}_Mx{Mx:d}My{My:d}Mz{Mz:d}_E{E:.2f}_szhr.dat  ….   real-space spin S_z operator</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>winfile</strong> (<em>str</em><em>, </em><em>optional</em>) – _description_. Defaults to ‘wannier90.win’.</p></li>
<li><p><strong>hr_R_file</strong> (<em>str</em><em>, </em><em>optional</em>) – _description_. Defaults to ‘hr_R_dict.pickle’.</p></li>
<li><p><strong>spn_R_file</strong> (<em>str</em><em>, </em><em>optional</em>) – _description_. Defaults to ‘spn_R_dict.pickle’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.dict_to_matrix">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">dict_to_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_wann</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.dict_to_matrix" title="Link to this definition">#</a></dt>
<dd><p>Convert hr or spn dictionary to a matrix accepted by wannierBerri: first index is m, second n, third is the index of an R_vector from iRvec list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dict</strong> (<em>dict</em>) – The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p></li>
<li><p><strong>num_wann</strong> (<em>int</em>) – The number of Wannier functions.</p></li>
<li><p><strong>spin_index</strong> (<em>bool</em>) – If True, the dictionary has spin index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The array of R vectors.
numpy array: The data matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.eigenval_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">eigenval_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigenval_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.eigenval_dict" title="Link to this definition">#</a></dt>
<dd><p>Return the eigenvalues as a dictionary with the keys being the k-point tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigenval_file</strong> (<em>str</em>) – The name of the eigenvalues file.</p></li>
<li><p><strong>win_file</strong> (<em>str</em>) – The name of the wannier90.win file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The eigenvalues dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.eigenval_for_kpoint">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">eigenval_for_kpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenval_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.eigenval_for_kpoint" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Return the eigenvalue at ‘kpoint’ and ‘band’.</dt><dd><p>!! kpoint must be one from the kpoints in the wannier90.win  file !!</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoint</strong> (<em>tuple</em>) – The k-point.</p></li>
<li><p><strong>band</strong> (<em>int</em>) – The band.</p></li>
<li><p><strong>eigenval_file</strong> (<em>str</em>) – The eigenvalue file.</p></li>
<li><p><strong>win_file</strong> (<em>str</em>) – The win file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The eigenvalue at ‘kpoint’ and ‘band’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.fermi_surface_spin_texture">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">fermi_surface_spin_texture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sx2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sy2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sz2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_F</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiver_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_for_quiver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_size_quiver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_by_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_Sx_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_Sy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_Sz_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points_for_one_angstrom_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim_margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_for_quiver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_line_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_head_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiver_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiver_scale_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_with_units_of_arrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_middle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.85,</span> <span class="pre">0.85,</span> <span class="pre">0.85,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.fermi_surface_spin_texture" title="Link to this definition">#</a></dt>
<dd><p>Plot scatter points with a spin texture on a constant energy xy surface (probably at E=EF)
if the energy difference of each given point is lower than some threshold.
If there is more such points, grab the one with minimum difference from the energy surface.</p>
<ul class="simple">
<li><p>E and E_thr in eV</p></li>
</ul>
<p>kpoints2D: 2D array of shape (Nkpoints, 3)
bands2D: 2D array of shape (Nkpoints, Nbands)</p>
<p>circumf_distance_of_arrows: distance between the arrows on the circumference of the circle = k (1/Angstrom) * phi (rad)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints2D</strong> (<em>np.array</em>) – The 2D k-points.</p></li>
<li><p><strong>bands2D</strong> (<em>np.array</em>) – The 2D bands.</p></li>
<li><p><strong>Sx2D</strong> (<em>np.array</em>) – The 2D Sx.</p></li>
<li><p><strong>Sy2D</strong> (<em>np.array</em>) – The 2D Sy.</p></li>
<li><p><strong>Sz2D</strong> (<em>np.array</em>) – The 2D Sz.</p></li>
<li><p><strong>ax</strong> (<em>plt.axis</em><em>, </em><em>optional</em>) – The axis.</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em>) – The energy.</p></li>
<li><p><strong>E_F</strong> (<em>float</em><em>, </em><em>optional</em>) – The Fermi energy.</p></li>
<li><p><strong>E_thr</strong> (<em>float</em><em>, </em><em>optional</em>) – The energy threshold.</p></li>
<li><p><strong>fig_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The figure name.</p></li>
<li><p><strong>quiver_scale</strong> (<em>float</em><em>, </em><em>optional</em>) – The quiver scale.</p></li>
<li><p><strong>scatter_for_quiver</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, scatter for quiver.</p></li>
<li><p><strong>scatter_size_quiver</strong> (<em>int</em><em>, </em><em>optional</em>) – The scatter size for quiver.</p></li>
<li><p><strong>scatter_size</strong> (<em>float</em><em>, </em><em>optional</em>) – The scatter size.</p></li>
<li><p><strong>reduce_by_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – The reduce by factor.</p></li>
<li><p><strong>kmesh_limits</strong> (<em>list</em><em>, </em><em>optional</em>) – The k-mesh limits.</p></li>
<li><p><strong>colorbar_Sx_lim</strong> (<em>list</em><em>, </em><em>optional</em>) – The colorbar limits for Sx.</p></li>
<li><p><strong>colorbar_Sy_lim</strong> (<em>list</em><em>, </em><em>optional</em>) – The colorbar limits for Sy.</p></li>
<li><p><strong>colorbar_Sz_lim</strong> (<em>list</em><em>, </em><em>optional</em>) – The colorbar limits for Sz.</p></li>
<li><p><strong>n_points_for_one_angstrom_radius</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of points for one Angstrom radius.</p></li>
<li><p><strong>ylim_margin</strong> (<em>float</em><em>, </em><em>optional</em>) – The y-limit margin.</p></li>
<li><p><strong>contour_for_quiver</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, contour for quiver.</p></li>
<li><p><strong>contour_line_width</strong> (<em>float</em><em>, </em><em>optional</em>) – The contour line width.</p></li>
<li><p><strong>arrow_linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – The arrow line width.</p></li>
<li><p><strong>arrow_head_width</strong> (<em>int</em><em>, </em><em>optional</em>) – The arrow head width.</p></li>
<li><p><strong>quiver_angles</strong> (<em>str</em><em>, </em><em>optional</em>) – The quiver angles.</p></li>
<li><p><strong>quiver_scale_units</strong> (<em>str</em><em>, </em><em>optional</em>) – The quiver scale units.</p></li>
<li><p><strong>inset_with_units_of_arrows</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the inset with units of arrows.</p></li>
<li><p><strong>color_middle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The middle color.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save the figure.</p></li>
<li><p><strong>showfig</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, show the figure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.files_wann90_to_dict_pickle">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">files_wann90_to_dict_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disentanglement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.files_wann90_to_dict_pickle" title="Link to this definition">#</a></dt>
<dd><p>Convert wannier90 files to pickled dictionaries files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_dir</strong> (<em>str</em>) – The model directory.</p></li>
<li><p><strong>disentanglement</strong> (<em>bool</em>) – If True, disentanglement is considered.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of bands and the number of wannier functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.get_2D_kpoint_mesh">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">get_2D_kpoint_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-0.5,</span> <span class="pre">0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.get_2D_kpoint_mesh" title="Link to this definition">#</a></dt>
<dd><p>Get a 2D mesh of k-points in the reciprocal space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>numpy array</em>) – The reciprocal lattice vectors.</p></li>
<li><p><strong>limits</strong> (<em>list</em><em> of </em><em>2 floats</em>) – The limits of the mesh.</p></li>
<li><p><strong>Nk</strong> (<em>int</em>) – The number of k-points in each direction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-points in the reciprocal space.
list of tuples: The k-points in the Cartesian space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.get_DFT_kgrid">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">get_DFT_kgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.get_DFT_kgrid" title="Link to this definition">#</a></dt>
<dd><p>Get the ‘mp_grid’ from wannier90.win file which tells the k-grid used in the DFT calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fin</strong> (<em>str</em>) – The name of the wannier90.win file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of 3 ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.get_kpoint_names">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">get_kpoint_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.get_kpoint_names" title="Link to this definition">#</a></dt>
<dd><p>Parse wannier90.win file to get k-point names as a list of tuples.
The k-point names are in the ‘begin kpoints’ and ‘end kpoints’ section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fwin</strong> (<em>str</em>) – The name of the wannier90.win file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-point names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.get_kpoint_path">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">get_kpoint_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nk</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.get_kpoint_path" title="Link to this definition">#</a></dt>
<dd><p>Interpolate between kpoints in the kpoint_matrix to obtain a k-point path with Nk points in each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoint_matrix</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-point matrix.</p></li>
<li><p><strong>G</strong> (<em>numpy array</em>) – The reciprocal lattice vectors.</p></li>
<li><p><strong>Nk</strong> (<em>int</em>) – The number of k-points in each segment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-points in the reciprocal space.
list of tuples: The k-points in the Cartesian space.
list of floats: The k-point distance position.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.get_skiprows_hr_dat">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">get_skiprows_hr_dat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90_hr.dat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.get_skiprows_hr_dat" title="Link to this definition">#</a></dt>
<dd><p>Get the number of skiprows in wannier90_hr.dat file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fin</strong> (<em>str</em>) – The name of the hr.dat file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of skiprows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.hr_wann90_to_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">hr_wann90_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fin_wannier90</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90_hr.dat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.hr_wann90_to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert wannier90 hr.dat to dictionary in the form that we are using: R vectors as keys
and hopping as a complex number matrix as the values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fin_wannier90</strong> (<em>str</em>) – The name of the hr.dat file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The hopping dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.interpolate_operator">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">interpolate_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operator_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_dis_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latt_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reciprocal_latt_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_mn_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(0,</span> <span class="pre">0,</span> <span class="pre">0)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_real_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_space_fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hr_R_dict.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./tb_model_wann90/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_pickle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.interpolate_operator" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Takes operator O (Hamiltonian, spin-operator …) evaluated on a coarse DFT k-mesh and Hamiltonian eigenstates onto ‘kpoints’ using the</dt><dd><ol class="arabic simple">
<li><p>(semi)unitary transformation defined by U_dis*U from the Hamiltonian gauge (eigenstate gauge)
to the Wannier gauge,</p></li>
<li><p>performing Fourier transform to the real-space using a set of lattice vectors</p></li>
<li><p>inverse Fourier transforming to the k-space for all the k-points from ‘kpoints’.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operator_dict</strong> (<em>dict</em>) – The operator dictionary.</p></li>
<li><p><strong>u_dis_dict</strong> (<em>dict</em>) – The disentangled unitary dictionary.</p></li>
<li><p><strong>u_dict</strong> (<em>dict</em>) – The unitary dictionary.</p></li>
<li><p><strong>latt_params</strong> (<em>np.array</em>) – The lattice parameters.</p></li>
<li><p><strong>reciprocal_latt_params</strong> (<em>np.array</em>) – The reciprocal lattice parameters.</p></li>
<li><p><strong>R_grid</strong> (<em>list</em>) – The R grid.</p></li>
<li><p><strong>U_mn_k</strong> (<em>dict</em><em>, </em><em>optional</em>) – The Hamiltonian eigenstates.</p></li>
<li><p><strong>hamiltonian</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the Hamiltonian is calculated.</p></li>
<li><p><strong>kpoints</strong> (<em>list</em><em>, </em><em>optional</em>) – The k-points.</p></li>
<li><p><strong>save_real_space</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save the real space.</p></li>
<li><p><strong>real_space_fname</strong> (<em>str</em><em>, </em><em>optional</em>) – The real space file name.</p></li>
<li><p><strong>save_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – The save folder.</p></li>
<li><p><strong>save_as_pickle</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save as pickle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>interpolated operator matrices (values) at the given k-points (keys) in the Hamiltonian gauge; unitary matrices which diagonalize the Hamiltonian (only if hamiltonian==True).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.load_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spn_dict.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.load_dict" title="Link to this definition">#</a></dt>
<dd><p>If not text_file, than it’s binary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fin</strong> (<em>str</em>) – The name of the file to load:
spn_dict.pickle / hr_R_dict.pickle / u_dict.pickle / u_dis_dict.pickle
spn_dict.dat / hr_R_dict.dat / u_dict.dat / u_dis_dict.dat</p></li>
<li><p><strong>text_file</strong> (<em>bool</em>) – If True, load as a text file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.load_eigenvals">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">load_eigenvals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigenval_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.eig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.load_eigenvals" title="Link to this definition">#</a></dt>
<dd><p>Parse the wannier90 .eig file to get the k-point and band-resolved eigenvalues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eigenval_file</strong> (<em>str</em>) – The name of the eigenvalues file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D list (n_kpoints X n_bands) containing the eigenvalues.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.load_lattice_vectors">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">load_lattice_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">win_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.load_lattice_vectors" title="Link to this definition">#</a></dt>
<dd><p>Return a 3x3 matrix where 1st row is the 1st lattice vector etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>win_file</strong> (<em>str</em>) – The name of the wannier90.win file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lattice vectors matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.magmom_OOP_or_IP">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">magmom_OOP_or_IP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">INCAR_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.magmom_OOP_or_IP" title="Link to this definition">#</a></dt>
<dd><p>Return True if MAGMOM in INCAR_path lies purely OOP, else return False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>INCAR_path</strong> (<em>str</em>) – The path to the INCAR file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if MAGMOM in INCAR_path lies purely OOP, else False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.magmom_direction">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">magmom_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">INCAR_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.magmom_direction" title="Link to this definition">#</a></dt>
<dd><p>Return 0 / 1 / 2  if spin is along x / y / z direction, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>INCAR_path</strong> (<em>str</em>) – The path to the INCAR file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 / 1 / 2  if spin is along x / y / z direction, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.material_name_to_latex">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">material_name_to_latex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">material</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.material_name_to_latex" title="Link to this definition">#</a></dt>
<dd><p>Convert the material name to LaTeX format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>material</strong> (<em>str</em>) – The material name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The LaTeX formatted material name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.matrix_to_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">matrix_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.matrix_to_dict" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Convert data matrix (e.g. the Ham_R or SS_R file from symmetrization) into a dictionary with</dt><dd><p>lattice vectors as keys and if spin_index is True then also (‘x’, ‘y’, ‘z’) for spin.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_matrix</strong> (<em>numpy array</em>) – The data matrix.</p></li>
<li><p><strong>Rvecs</strong> (<em>numpy array</em>) – The lattice vectors.</p></li>
<li><p><strong>spin_index</strong> (<em>bool</em>) – If True, the dictionary has spin index.</p></li>
<li><p><strong>spin_names</strong> (<em>list</em><em> of </em><em>3 str</em>) – The spin names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.operator_exp_values">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">operator_exp_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Operator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.operator_exp_values" title="Link to this definition">#</a></dt>
<dd><p>Return the expectation values of Operator (an N x N matrix, where N is the size of the eigenvectors) for all eigenvectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigvecs</strong> (<em>array</em><em> of </em><em>matrices</em>) – Array of M square matrices. Each N x N square matrix contains N eigenvectors (columns of the matrix).</p></li>
<li><p><strong>Operator</strong> (<em>matrix</em>) – N x N Hermition matrix acting on the eigenvectors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>M x N array of expectation values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.outer">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">outer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.outer" title="Link to this definition">#</a></dt>
<dd><p>Outer product between a 2x2 spin matrix and a general orbital nxn M matrix,
so that the spin blocks are the big blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – Pauli (2 x 2) matrix sx, sy or sz</p></li>
<li><p><strong>M</strong> (<em>np.array</em>) – general orbital (n x n) matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.outer2">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">outer2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.outer2" title="Link to this definition">#</a></dt>
<dd><p>Works for s matrix of any dimension, but slower than ‘outer(s, M)’
Outer product between a nxn spin matrix and a general orbital nxn M matrix,
so that the spin blocks are the big blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – Pauli (2 x 2) matrix sx, sy or sz</p></li>
<li><p><strong>M</strong> (<em>np.array</em>) – general orbital (n x n) matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.parse_KPOINTS_file">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">parse_KPOINTS_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">KPOINTS_file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.parse_KPOINTS_file" title="Link to this definition">#</a></dt>
<dd><p>Parse the KPOINTS file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KPOINTS_file_path</strong> (<em>str</em>) – The KPOINTS file path.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-point matrix, the number of k-points, and the k-path ticks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.plot_bands_spin_texture">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">plot_bands_spin_texture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath_ticks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eigs_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_F</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spin_texture_1D_home_made.jpg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_caption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Wannier</span> <span class="pre">interpolation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-5,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.plot_bands_spin_texture" title="Link to this definition">#</a></dt>
<dd><p>Output a figure with Sx, Sy, and Sz-projected band structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points in the reciprocal space.</p></li>
<li><p><strong>kpath</strong> (<em>list</em><em> of </em><em>floats</em>) – The k-point distance position.</p></li>
<li><p><strong>kpath_ticks</strong> (<em>list</em><em> of </em><em>floats</em>) – The k-point ticks.</p></li>
<li><p><strong>Eigs_k</strong> (<em>dict</em>) – The eigenvalues dictionary.</p></li>
<li><p><strong>S_mn_k_H_x</strong> (<em>dict</em>) – The Sx operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>S_mn_k_H_y</strong> (<em>dict</em>) – The Sy operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>S_mn_k_H_z</strong> (<em>dict</em>) – The Sz operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>E_F</strong> (<em>float</em>) – The Fermi level in eV.</p></li>
<li><p><strong>fout</strong> (<em>str</em>) – The name of the output file.</p></li>
<li><p><strong>fig_caption</strong> (<em>str</em>) – The caption of the figure.</p></li>
<li><p><strong>yaxis_lim</strong> (<em>list</em><em> of </em><em>2 floats</em>) – The y-axis limits.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em>) – If True, save the figure.</p></li>
<li><p><strong>showfig</strong> (<em>bool</em>) – If True, show the figure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.read_PROCAR_lines_for_kpoint">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">read_PROCAR_lines_for_kpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PROCAR_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PROCAR'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.read_PROCAR_lines_for_kpoint" title="Link to this definition">#</a></dt>
<dd><p>Get the section of PROCAR belonging to the first occurence of ‘kpoint’ in PROCAR_file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoint</strong> (<em>tuple</em>) – The k-point.</p></li>
<li><p><strong>PROCAR_file</strong> (<em>str</em>) – The PROCAR file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lines of PROCAR belonging to the first occurence of ‘kpoint’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.real_space_grid_from_hr_dat">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">real_space_grid_from_hr_dat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90_hr.dat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.real_space_grid_from_hr_dat" title="Link to this definition">#</a></dt>
<dd><p>Get the real-space grid from the seedname_hr.dat file.
See Pizzi 2020 Sec. 4.2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>str</em>) – The name of the hr.dat file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The real-space grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.real_to_W_gauge">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">real_to_W_gauge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O_mn_R_W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.real_to_W_gauge" title="Link to this definition">#</a></dt>
<dd><p>Perform inverse Fourier transformation from real-space operator to k-space in Wannier gauge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points.</p></li>
<li><p><strong>O_mn_R_W</strong> (<em>dict</em>) – The real-space operator dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-space operator dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.real_to_W_gauge_accelerated">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">real_to_W_gauge_accelerated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O_mn_R_W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.real_to_W_gauge_accelerated" title="Link to this definition">#</a></dt>
<dd><p>Perform inverse Fourier transformation from real-space operator to k-space in Wannier gauge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points.</p></li>
<li><p><strong>O_mn_R_W</strong> (<em>dict</em>) – The real-space operator dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The k-space operator dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.reciprocal_lattice_vectors">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">reciprocal_lattice_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real_space_lattice_vector_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.reciprocal_lattice_vectors" title="Link to this definition">#</a></dt>
<dd><p>Return the reciprocal lattice vectors from the real-space lattice vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>real_space_lattice_vector_matrix</strong> (<em>numpy array</em>) – The real-space lattice vectors matrix.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reciprocal lattice vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.replace_middle_of_cmap_with_custom_color">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">replace_middle_of_cmap_with_custom_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color_middle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.85,</span> <span class="pre">0.85,</span> <span class="pre">0.85,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">middle_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.replace_middle_of_cmap_with_custom_color" title="Link to this definition">#</a></dt>
<dd><p>Replace the middle of the colormap with a custom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color_middle</strong> (<em>tuple</em>) – The middle color.</p></li>
<li><p><strong>middle_range</strong> (<em>float</em>) – The middle range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new colormap.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cmap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.save_bands_and_spin_texture">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">save_bands_and_spin_texture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoints_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eigs_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh_2D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bands_spin.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./tb_model_wann90/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.save_bands_and_spin_texture" title="Link to this definition">#</a></dt>
<dd><p>Save the bands and spin texture information for given kpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints_rec</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points in the reciprocal space.</p></li>
<li><p><strong>kpoints_cart</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points in the Cartesian space.</p></li>
<li><p><strong>kpath</strong> (<em>list</em><em> of </em><em>floats</em>) – The k-point distance position.</p></li>
<li><p><strong>Eigs_k</strong> (<em>dict</em>) – The eigenvalues dictionary.</p></li>
<li><p><strong>S_mn_k_H_x</strong> (<em>dict</em>) – The Sx operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>S_mn_k_H_y</strong> (<em>dict</em>) – The Sy operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>S_mn_k_H_z</strong> (<em>dict</em>) – The Sz operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>kmesh_2D</strong> (<em>bool</em>) – If True, the k-points are in a 2D mesh.</p></li>
<li><p><strong>fout</strong> (<em>str</em>) – The name of the output file.</p></li>
<li><p><strong>save_folder</strong> (<em>str</em>) – The folder where to save the file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.save_bands_and_spin_texture_old">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">save_bands_and_spin_texture_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoints_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eigs_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_mn_k_H_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh_2D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bands_spin.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./tb_model_wann90/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.save_bands_and_spin_texture_old" title="Link to this definition">#</a></dt>
<dd><p>Save the bands and spin texture information for given kpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints_rec</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points in the reciprocal space.</p></li>
<li><p><strong>kpoints_cart</strong> (<em>list</em><em> of </em><em>tuples</em>) – The k-points in the Cartesian space.</p></li>
<li><p><strong>kpath</strong> (<em>list</em><em> of </em><em>floats</em>) – The k-point distance position.</p></li>
<li><p><strong>Eigs_k</strong> (<em>dict</em>) – The eigenvalues dictionary.</p></li>
<li><p><strong>S_mn_k_H_x</strong> (<em>dict</em>) – The Sx operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>S_mn_k_H_y</strong> (<em>dict</em>) – The Sy operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>S_mn_k_H_z</strong> (<em>dict</em>) – The Sz operator dictionary in Hamiltonian gauge.</p></li>
<li><p><strong>kmesh_2D</strong> (<em>bool</em>) – If True, the k-points are in a 2D mesh.</p></li>
<li><p><strong>fout</strong> (<em>str</em>) – The name of the output file.</p></li>
<li><p><strong>save_folder</strong> (<em>str</em>) – The folder where to save the file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.selected_band_plot">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">selected_band_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.selected_band_plot" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.split_spn_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">split_spn_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spn_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.split_spn_dict" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Split dictionary with keys as ((Rx, Ry, Rz), spin_component_name) to three dictionaries</dt><dd><p>with keys as (Rx, Ry, Rz).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spn_dict</strong> (<em>dict</em>) – The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p></li>
<li><p><strong>spin_names</strong> (<em>list</em><em> of </em><em>3 str</em>) – The spin names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary with R vectors as keys and hopping as a complex number matrix as the values.
dict: The dictionary with R vectors as keys and hopping as a complex number matrix as the values.
dict: The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.spn_to_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">spn_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.spn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formatted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spn_dict.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.spn_to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert wannier90.spn file to a dictionary object and save as pickle.
If ‘text_file’ == True, then save as a human-readable text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_dir</strong> (<em>str</em>) – The directory of the model.</p></li>
<li><p><strong>fwin</strong> (<em>str</em>) – The win file.</p></li>
<li><p><strong>fin</strong> (<em>str</em>) – The spn file.</p></li>
<li><p><strong>formatted</strong> (<em>bool</em>) – If True, the spn file is formatted.</p></li>
<li><p><strong>fout</strong> (<em>str</em>) – The output file.</p></li>
<li><p><strong>save_as_text</strong> (<em>bool</em>) – If True, save as a text file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The spin-projection matrices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.u_to_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">u_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90_u.mat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_dict.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.u_to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert _u.mat from wannier90 to pickled python dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fin</strong> (<em>str</em>) – The input file.</p></li>
<li><p><strong>fout</strong> (<em>str</em>) – The output file.</p></li>
<li><p><strong>text_file</strong> (<em>bool</em>) – If True, save as a text file.</p></li>
<li><p><strong>write_sparse</strong> (<em>bool</em>) – If True, write the sparse matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of bands and the number of wannier functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.uniform_real_space_grid">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">uniform_real_space_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R_mesh_ijk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">5,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.uniform_real_space_grid" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>From the maxima in each direction, make a regular mesh</dt><dd><p>(-R_max_i, +R_max_i) x (-R_max_j, +R_max_j) x (-R_max_k, +R_max_k).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>R_mesh_ijk</strong> (<em>tuple</em><em> of </em><em>3 ints</em>) – The number of mesh points in each direction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The real-space grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.unite_spn_dict">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">unite_spn_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spn_x_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spn_y_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spn_z_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.unite_spn_dict" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Unite dictionary with keys as (Rx, Ry, Rz) to three dictionaries</dt><dd><p>with keys as ((Rx, Ry, Rz), spin_component_name).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spn_x_dict</strong> (<em>dict</em>) – The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p></li>
<li><p><strong>spn_y_dict</strong> (<em>dict</em>) – The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p></li>
<li><p><strong>spn_z_dict</strong> (<em>dict</em>) – The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p></li>
<li><p><strong>spin_names</strong> (<em>list</em><em> of </em><em>3 str</em>) – The spin names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary with R vectors as keys and hopping as a complex number matrix as the values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_utils.wannier_energy_windows">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_utils.</span></span><span class="sig-name descname"><span class="pre">wannier_energy_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wann_bands_lims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenval_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.eig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_utils.wannier_energy_windows" title="Link to this definition">#</a></dt>
<dd><p>Get energy window limits for wannierization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wann_bands_lims</strong> (<em>tuple</em><em> of </em><em>two int</em>) – Zero-indexed indices of the minimum and maximum bands included in wannierization. E.g. (0, 21) if the bottom 22 bands should be wannierized.</p></li>
<li><p><strong>E_F</strong> (<em>float</em><em>, </em><em>optional</em>) – The Fermi level in eV. Defaults to 0.0.</p></li>
<li><p><strong>eigenval_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Wannier90 .eig file name. Defaults to “wannier90.eig”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the wannierization and frozen energy minima and maxima.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>4 floats</p>
</dd>
</dl>
</dd></dl>

<p id="module-spinWannier.wannier_quality_utils">Utility functions for the wannier_quality method of the spinWannier.WannierTBmodel.WannierTBmodel class.</p>
<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.compare_eigs_bandstructure_at_exact_kpts">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">compare_eigs_bandstructure_at_exact_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dft_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wann_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_wann</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_name_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'WannierBerri_quality_error_Fermi_corrected.dat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.compare_eigs_bandstructure_at_exact_kpts" title="Link to this definition">#</a></dt>
<dd><p>Compare the DFT and Wannierized band structures at the exact k-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dft_bands</strong> (<em>np.array</em>) – DFT bands.</p></li>
<li><p><strong>wann_bands</strong> (<em>np.array</em>) – Wannierized bands.</p></li>
<li><p><strong>num_kpoints</strong> (<em>int</em>) – Number of k-points.</p></li>
<li><p><strong>num_wann</strong> (<em>int</em>) – Number of Wannierized bands.</p></li>
<li><p><strong>f_name_out</strong> (<em>str</em><em>, </em><em>optional</em>) – Output file name. Defaults to ‘WannierBerri_quality_error_Fermi_corrected.dat’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the DFT energy in the first column and the Wannierization error in the second column.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.duplicate_kpoints_for_home_made">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">duplicate_kpoints_for_home_made</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NK</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.duplicate_kpoints_for_home_made" title="Link to this definition">#</a></dt>
<dd><p>Duplicate also the last k-point (in  dictionary the keys are unique, so actually the data in the dictionaries where keys are k-points contain only one of each k-point, so if k-path starts and ends with the same k-point, only the first one is recorded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em>) – Data to duplicate.</p></li>
<li><p><strong>NK</strong> (<em>int</em>) – Number of k-points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Duplicated data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.get_NKpoints">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">get_NKpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">OUTCAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'OUTCAR'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.get_NKpoints" title="Link to this definition">#</a></dt>
<dd><p>Return number of kpoints from bands calculation from OUTCAR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>OUTCAR</strong> (<em>str</em><em>, </em><em>optional</em>) – OUTCAR path. Defaults to ‘OUTCAR’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of k-points stated in the OUTCAR</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.get_band_at_kpoint_from_EIGENVAL">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">get_band_at_kpoint_from_EIGENVAL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EIGENVAL_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./EIGENVAL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_kpoint_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.0000000E+00</span>&#160; <span class="pre">0.0000000E+00</span>&#160; <span class="pre">0.0000000E+00'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.get_band_at_kpoint_from_EIGENVAL" title="Link to this definition">#</a></dt>
<dd><p>Get the energy of the target_band at the target_kpoint from the EIGENVAL file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>EIGENVAL_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the EIGENVAL file. Defaults to ‘./EIGENVAL’.</p></li>
<li><p><strong>target_band</strong> (<em>int</em><em>, </em><em>optional</em>) – Target band. Defaults to 1.</p></li>
<li><p><strong>target_kpoint_string</strong> (<em>str</em><em>, </em><em>optional</em>) – Target k-point string. Defaults to ‘0.0000000E+00  0.0000000E+00  0.0000000E+00’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Energy of the target_band at the target_kpoint.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.get_fermi">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">get_fermi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.get_fermi" title="Link to this definition">#</a></dt>
<dd><p>Extract Fermi energy from the DOSCAR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the directory with the DOSCAR file. Defaults to “.”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fermi energy in eV.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.get_fermi_corrected_by_matching_bands">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">get_fermi_corrected_by_matching_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsc_calculation_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../0_nsc_for_wann_25x25_frozmaxmargin_0.2eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrected_at_kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.0000000E+00</span>&#160; <span class="pre">0.0000000E+00</span>&#160; <span class="pre">0.0000000E+00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrected_at_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc_calculation_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../sc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FERMI_ENERGY_corrected.in'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.get_fermi_corrected_by_matching_bands" title="Link to this definition">#</a></dt>
<dd><p>Get the Fermi energy from the self-consistent calculation and correct it so that the band at the target_kpoint and target_band is at the same energy in the non-self-consistent calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the directory with the DOSCAR file. Defaults to “.”.</p></li>
<li><p><strong>nsc_calculation_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the non-self-consistent calculation directory. Defaults to ‘../0_nsc_for_wann_25x25_frozmaxmargin_0.2eV’.</p></li>
<li><p><strong>corrected_at_kpoint</strong> (<em>str</em><em>, </em><em>optional</em>) – Target k-point string. Defaults to ‘0.0000000E+00  0.0000000E+00  0.0000000E+00’.</p></li>
<li><p><strong>corrected_at_band</strong> (<em>int</em><em>, </em><em>optional</em>) – Target band. Defaults to 11.</p></li>
<li><p><strong>sc_calculation_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the self-consistent calculation directory. Defaults to “../sc”.</p></li>
<li><p><strong>fout_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Output file name. Defaults to “FERMI_ENERGY_corrected.in”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Corrected Fermi energy in eV.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.get_frozen_window_min_max">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">get_frozen_window_min_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wannier90winfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier90.win'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.get_frozen_window_min_max" title="Link to this definition">#</a></dt>
<dd><p>Get the frozen window min and max from the wannier90.win file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wannier90winfile</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the wannier90.win file. Defaults to ‘wannier90.win’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Frozen window min.
float: Frozen window max.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.integrate_error">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">integrate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_by_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.integrate_error" title="Link to this definition">#</a></dt>
<dd><p>Integrate the error in ‘f_name_in’ in the energy range [E_min, E_max] included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_by_energy</strong> (<em>np.array</em>) – Error vs. energy.</p></li>
<li><p><strong>E_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum energy. Defaults to -1e3.</p></li>
<li><p><strong>E_max</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum energy. Defaults to 1e3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the integrated error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.parse_eigenval_file">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">parse_eigenval_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.parse_eigenval_file" title="Link to this definition">#</a></dt>
<dd><p>Parse the EIGENVAL file and return the kpoints, bands, number of kpoints, and number of bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fin</strong> (<em>str</em>) – Path to the EIGENVAL file.</p></li>
<li><p><strong>spin</strong> (<em>int</em><em>, </em><em>optional</em>) – Spin index. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>kpoints.
np.array: bands.
int: number of kpoints.
int: number of bands.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.plot_err_vs_bands">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">plot_err_vs_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath_ticks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eigs_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ERRORS_ALL_band_structure.jpg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.plot_err_vs_bands" title="Link to this definition">#</a></dt>
<dd><p>Output a figure with RMSE_E, RMSE_Sx, RMSE_Sy, and RMSE_Sz-projected band structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoints</strong> (<em>np.array</em>) – kpoints.</p></li>
<li><p><strong>kpath</strong> (<em>np.array</em>) – kpath.</p></li>
<li><p><strong>kpath_ticks</strong> (<em>list</em>) – kpath ticks.</p></li>
<li><p><strong>Eigs_k</strong> (<em>dict</em>) – Eigs_k.</p></li>
<li><p><strong>E_diff</strong> (<em>np.array</em>) – E_diff.</p></li>
<li><p><strong>S_diff</strong> (<em>np.array</em>) – S_diff.</p></li>
<li><p><strong>fout</strong> (<em>str</em><em>, </em><em>optional</em>) – Output file name. Defaults to ‘ERRORS_ALL_band_structure.jpg’.</p></li>
<li><p><strong>yaxis_lim</strong> (<em>list</em><em>, </em><em>optional</em>) – y-axis limits. Defaults to None.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the figure. Defaults to True.</p></li>
<li><p><strong>showfig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show the figure. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.plot_err_vs_energy">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">plot_err_vs_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_by_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Wannierization</span> <span class="pre">RMS</span> <span class="pre">error</span> <span class="pre">vs.</span> <span class="pre">energy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wannier_quality_error_by_energy.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.plot_err_vs_energy" title="Link to this definition">#</a></dt>
<dd><p>Plot the error vs. energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_by_energy</strong> (<em>np.array</em>) – Error vs. energy.</p></li>
<li><p><strong>Ef</strong> (<em>float</em>) – Fermi energy.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title of the plot. Defaults to “Wannierization RMS error vs. energy”.</p></li>
<li><p><strong>fig_name_out</strong> (<em>str</em><em>, </em><em>optional</em>) – Output file name. Defaults to “wannier_quality_error_by_energy.png”.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the figure. Defaults to True.</p></li>
<li><p><strong>showfig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show the figure. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spinWannier.wannier_quality_utils.wannier_quality_calculation">
<span class="sig-prename descclassname"><span class="pre">spinWannier.wannier_quality_utils.</span></span><span class="sig-name descname"><span class="pre">wannier_quality_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NK</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpath_ticks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fermi_nsc_wann</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_wann</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard_first_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0_self-consistent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsc_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1_non-self-consistent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wann_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2_wannier'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1_band_structure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2_wannier/tb_model_wann90'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_for_Fermi_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint_for_Fermi_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.0000000E+00</span>&#160; <span class="pre">0.0000000E+00</span>&#160; <span class="pre">0.0000000E+00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spinWannier.wannier_quality_utils.wannier_quality_calculation" title="Link to this definition">#</a></dt>
<dd><p>Calculate the quality of the Wannierization.</p>
<p>Needed files from VASP:</p>
<blockquote>
<div><dl class="simple">
<dt>= nsc_calculation_path:</dt><dd><ul class="simple">
<li><p>EIGENVAL</p></li>
<li><p>DOSCAR</p></li>
</ul>
</dd>
<dt>= dft_bands_folder:</dt><dd><ul class="simple">
<li><p>EIGENVAL</p></li>
<li><p>“Sxyz_exp_values_from_spn_file.dat” (get automatically from wannier90.spn_formatted!!)</p></li>
<li><p>OUTCAR</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoint_matrix</strong> (<em>np.array</em>) – K-point matrix.</p></li>
<li><p><strong>NK</strong> (<em>int</em>) – Number of k-points.</p></li>
<li><p><strong>kpath_ticks</strong> (<em>list</em>) – K-path ticks.</p></li>
<li><p><strong>Fermi_nsc_wann</strong> (<em>float</em>) – Fermi energy in the non-self-consistent calculation.</p></li>
<li><p><strong>num_wann</strong> (<em>int</em>) – Number of Wannierized bands.</p></li>
<li><p><strong>discard_first_bands</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bands to discard. Defaults to 0.</p></li>
<li><p><strong>sc_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the self-consistent calculation directory. Defaults to ‘0_self-consistent’.</p></li>
<li><p><strong>nsc_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the non-self-consistent calculation directory. Defaults to ‘1_non-self-consistent’.</p></li>
<li><p><strong>wann_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the Wannier calculation directory. Defaults to ‘2_wannier’.</p></li>
<li><p><strong>bands_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the bands calculation directory. Defaults to ‘1_band_structure’.</p></li>
<li><p><strong>tb_model_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the wannier90.tb_model directory. Defaults to ‘2_wannier/tb_model_wann90’.</p></li>
<li><p><strong>band_for_Fermi_correction</strong> (<em>int</em><em>, </em><em>optional</em>) – Band for Fermi correction. Defaults to None.</p></li>
<li><p><strong>kpoint_for_Fermi_correction</strong> (<em>str</em><em>, </em><em>optional</em>) – K-point for Fermi correction. Defaults to ‘0.0000000E+00  0.0000000E+00  0.0000000E+00’.</p></li>
<li><p><strong>yaxis_lim</strong> (<em>list</em><em>, </em><em>optional</em>) – Y-axis limits. Defaults to None.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the figure. Defaults to True.</p></li>
<li><p><strong>showfig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show the figure. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Error by energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="classes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Classes</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.S_xyz_expectation_values"><code class="docutils literal notranslate"><span class="pre">S_xyz_expectation_values()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.W_gauge_to_H_gauge"><code class="docutils literal notranslate"><span class="pre">W_gauge_to_H_gauge()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.band_with_spin_projection_under_threshold_for_kpoint"><code class="docutils literal notranslate"><span class="pre">band_with_spin_projection_under_threshold_for_kpoint()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.check_file_exists"><code class="docutils literal notranslate"><span class="pre">check_file_exists()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.coerce_R_vectors_to_basic_supercell"><code class="docutils literal notranslate"><span class="pre">coerce_R_vectors_to_basic_supercell()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.coerce_to_positive_angles"><code class="docutils literal notranslate"><span class="pre">coerce_to_positive_angles()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.convert_wann_TB_model_for_QuT"><code class="docutils literal notranslate"><span class="pre">convert_wann_TB_model_for_QuT()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.dict_to_matrix"><code class="docutils literal notranslate"><span class="pre">dict_to_matrix()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.eigenval_dict"><code class="docutils literal notranslate"><span class="pre">eigenval_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.eigenval_for_kpoint"><code class="docutils literal notranslate"><span class="pre">eigenval_for_kpoint()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.fermi_surface_spin_texture"><code class="docutils literal notranslate"><span class="pre">fermi_surface_spin_texture()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.files_wann90_to_dict_pickle"><code class="docutils literal notranslate"><span class="pre">files_wann90_to_dict_pickle()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_2D_kpoint_mesh"><code class="docutils literal notranslate"><span class="pre">get_2D_kpoint_mesh()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_DFT_kgrid"><code class="docutils literal notranslate"><span class="pre">get_DFT_kgrid()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_kpoint_names"><code class="docutils literal notranslate"><span class="pre">get_kpoint_names()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_kpoint_path"><code class="docutils literal notranslate"><span class="pre">get_kpoint_path()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.get_skiprows_hr_dat"><code class="docutils literal notranslate"><span class="pre">get_skiprows_hr_dat()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.hr_wann90_to_dict"><code class="docutils literal notranslate"><span class="pre">hr_wann90_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.interpolate_operator"><code class="docutils literal notranslate"><span class="pre">interpolate_operator()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.load_dict"><code class="docutils literal notranslate"><span class="pre">load_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.load_eigenvals"><code class="docutils literal notranslate"><span class="pre">load_eigenvals()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.load_lattice_vectors"><code class="docutils literal notranslate"><span class="pre">load_lattice_vectors()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.magmom_OOP_or_IP"><code class="docutils literal notranslate"><span class="pre">magmom_OOP_or_IP()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.magmom_direction"><code class="docutils literal notranslate"><span class="pre">magmom_direction()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.material_name_to_latex"><code class="docutils literal notranslate"><span class="pre">material_name_to_latex()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.matrix_to_dict"><code class="docutils literal notranslate"><span class="pre">matrix_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.operator_exp_values"><code class="docutils literal notranslate"><span class="pre">operator_exp_values()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.outer"><code class="docutils literal notranslate"><span class="pre">outer()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.outer2"><code class="docutils literal notranslate"><span class="pre">outer2()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.parse_KPOINTS_file"><code class="docutils literal notranslate"><span class="pre">parse_KPOINTS_file()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.plot_bands_spin_texture"><code class="docutils literal notranslate"><span class="pre">plot_bands_spin_texture()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.read_PROCAR_lines_for_kpoint"><code class="docutils literal notranslate"><span class="pre">read_PROCAR_lines_for_kpoint()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.real_space_grid_from_hr_dat"><code class="docutils literal notranslate"><span class="pre">real_space_grid_from_hr_dat()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.real_to_W_gauge"><code class="docutils literal notranslate"><span class="pre">real_to_W_gauge()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.real_to_W_gauge_accelerated"><code class="docutils literal notranslate"><span class="pre">real_to_W_gauge_accelerated()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.reciprocal_lattice_vectors"><code class="docutils literal notranslate"><span class="pre">reciprocal_lattice_vectors()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.replace_middle_of_cmap_with_custom_color"><code class="docutils literal notranslate"><span class="pre">replace_middle_of_cmap_with_custom_color()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.save_bands_and_spin_texture"><code class="docutils literal notranslate"><span class="pre">save_bands_and_spin_texture()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.save_bands_and_spin_texture_old"><code class="docutils literal notranslate"><span class="pre">save_bands_and_spin_texture_old()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.selected_band_plot"><code class="docutils literal notranslate"><span class="pre">selected_band_plot()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.split_spn_dict"><code class="docutils literal notranslate"><span class="pre">split_spn_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.spn_to_dict"><code class="docutils literal notranslate"><span class="pre">spn_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.u_to_dict"><code class="docutils literal notranslate"><span class="pre">u_to_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.uniform_real_space_grid"><code class="docutils literal notranslate"><span class="pre">uniform_real_space_grid()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.unite_spn_dict"><code class="docutils literal notranslate"><span class="pre">unite_spn_dict()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_utils.wannier_energy_windows"><code class="docutils literal notranslate"><span class="pre">wannier_energy_windows()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.compare_eigs_bandstructure_at_exact_kpts"><code class="docutils literal notranslate"><span class="pre">compare_eigs_bandstructure_at_exact_kpts()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.duplicate_kpoints_for_home_made"><code class="docutils literal notranslate"><span class="pre">duplicate_kpoints_for_home_made()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_NKpoints"><code class="docutils literal notranslate"><span class="pre">get_NKpoints()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_band_at_kpoint_from_EIGENVAL"><code class="docutils literal notranslate"><span class="pre">get_band_at_kpoint_from_EIGENVAL()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_fermi"><code class="docutils literal notranslate"><span class="pre">get_fermi()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_fermi_corrected_by_matching_bands"><code class="docutils literal notranslate"><span class="pre">get_fermi_corrected_by_matching_bands()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.get_frozen_window_min_max"><code class="docutils literal notranslate"><span class="pre">get_frozen_window_min_max()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.integrate_error"><code class="docutils literal notranslate"><span class="pre">integrate_error()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.parse_eigenval_file"><code class="docutils literal notranslate"><span class="pre">parse_eigenval_file()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.plot_err_vs_bands"><code class="docutils literal notranslate"><span class="pre">plot_err_vs_bands()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.plot_err_vs_energy"><code class="docutils literal notranslate"><span class="pre">plot_err_vs_energy()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spinWannier.wannier_quality_utils.wannier_quality_calculation"><code class="docutils literal notranslate"><span class="pre">wannier_quality_calculation()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Libor Vojáček
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Libor Vojáček.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>